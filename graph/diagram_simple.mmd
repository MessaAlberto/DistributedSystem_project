%%{init: {'theme': 'base', 'themeVariables': {
  'primaryColor': '#E3F2FD',
  'primaryTextColor': '#1565C0',
  'primaryBorderColor': '#1565C0',
  'lineColor': '#5C6BC0',
  'secondaryColor': '#F3E5F5',
  'tertiaryColor': '#E8F5E9',
  'noteBkgColor': '#FFF9C4',
  'noteTextColor': '#333',
  'noteBorderColor': '#FBC02D',
  'actorBkg': '#E3F2FD',
  'actorBorder': '#1565C0',
  'actorTextColor': '#1565C0',
  'signalColor': '#5C6BC0',
  'signalTextColor': '#333'
}}}%%
sequenceDiagram
    autonumber
    participant client0 as client0
    participant client1 as client1
    participant client2 as client2
    participant Node0 as Node0
    participant Node10 as Node10
    participant Node20 as Node20
    participant Node27 as Node27
    participant Node40 as Node40
    participant Node70 as Node70
    participant TestManager as Manager

    rect rgba(173, 216, 230, 0.3)
    Note over client0,TestManager: SINGLE-CLIENT BASIC TEST
    client0->>Node20: WRITE (key=25)
    client0->>TestManager: WRITE (key=25 [OK])
    client0->>Node20: READ (key=25)
    client0->>TestManager: READ (key=25 [OK])
    end
    rect rgba(144, 238, 144, 0.3)
    Note over client0,TestManager: NODE JOIN TEST
    Note over Node27: JOINED
    end
    rect rgba(255, 218, 185, 0.3)
    Note over client0,TestManager: NODE LEAVE TEST
    end
    rect rgba(221, 160, 221, 0.3)
    Note over client0,TestManager: NODE CRASH TEST
    end
    rect rgba(176, 224, 230, 0.3)
    Note over client0,TestManager: NODE RECOVER TEST
    end
    rect rgba(255, 182, 193, 0.3)
    Note over client0,TestManager: RECOVERY VIA TEST
    Note over Node40: RECOVERED
    end
    rect rgba(255, 255, 224, 0.3)
    Note over client0,TestManager: SEQUENTIAL CONSISTENCY TEST
    client2->>Node20: WRITE (key=65)
    client2->>TestManager: WRITE (key=65 [OK])
    client0->>Node27: WRITE (key=65)
    client0->>TestManager: WRITE (key=65 [OK])
    client1->>Node40: READ (key=65)
    client1->>TestManager: READ (key=65 [OK])
    end
    rect rgba(211, 211, 211, 0.3)
    Note over client0,TestManager: RECOVER LOST WRITES TEST
    client2->>Node40: WRITE (key=65)
    client2->>TestManager: WRITE (key=65 [OK])
    end
    rect rgba(173, 216, 230, 0.3)
    Note over client0,TestManager: RECOVERY VIA TEST
    Note over Node10: RECOVERED
    client0->>Node27: READ (key=65)
    client0->>TestManager: READ (key=65 [OK])
    end
    rect rgba(144, 238, 144, 0.3)
    Note over client0,TestManager: READ MISSING KEY TEST
    client1->>Node20: READ (key=999)
    client1->>TestManager: WRITE (key=999 [FAIL])
    end
    rect rgba(255, 218, 185, 0.3)
    Note over client0,TestManager: CONCURRENT WRITES SAME KEY TEST
    client2->>Node0: WRITE (key=18)
    client0->>Node40: WRITE (key=18)
    client0->>TestManager: WRITE (key=18 [OK])
    client1->>TestManager: READ (key=999 [FAIL])
    client2->>Node27: READ (key=18)
    client2->>TestManager: WRITE (key=18 [FAIL])
    Note over Node0: TIMEOUT
    client2->>TestManager: WRITE (key=18 [FAIL])
    client2->>TestManager: READ (key=18 [FAIL])
    end
    rect rgba(221, 160, 221, 0.3)
    Note over client0,TestManager: REQUEST DURING NODE ACTION TEST
    Note over Node70: JOINED
    end
    rect rgba(176, 224, 230, 0.3)
    Note over client0,TestManager: NODE ACTION DURING REQUEST TEST
    client2->>Node10: READ (key=18)
    client2->>TestManager: READ (key=18 [OK])
    end
    rect rgba(255, 182, 193, 0.3)
    Note over client0,TestManager: ASK TO CRASHED NODE TEST
    client0->>Node27: WRITE (key=30)
    client0->>TestManager: WRITE (key=30 [FAIL])
    client1->>Node40: READ (key=30)
    client1->>TestManager: READ (key=30 [FAIL])
    end
    rect rgba(255, 255, 224, 0.3)
    Note over client0,TestManager: FAILING JOIN TEST
    end
    rect rgba(211, 211, 211, 0.3)
    Note over client0,TestManager: FAILING RECOVER TEST
    end
    rect rgba(173, 216, 230, 0.3)
    Note over client0,TestManager: RECOVERY VIA TEST
    end